<HTML>
<HEAD>
<TITLE>ActiveOPAL Web Control</TITLE>
</HEAD>

<BODY>
<div id="combo1" name="combo1"></div><br/>
<div id="combo2" name="combo2"></div>
<OBJECT ID="ActiveOPAL" CLASSID="CLSID:4B70E933-5B67-47DB-BADF-D86500FAC381" width="0" height="0" style="visibility:hidden"></OBJECT>
<div id="myDiv"></div>
<SCRIPT LANGUAGE="JavaScript">
var opal = document.getElementById('ActiveOPAL');
function PassParameter()
{
var sel1 = document.getElementById("c1"); 
var sel2 = document.getElementById("c2"); 


opal.SetSoundPlayerDevice = sel1.options[sel1.selectedIndex].value;
opal.SetSoundRecorderDevice = sel2.options[sel1.selectedIndex].value;

opal.Initialize();


opal.Registrar = "";	
opal.UserName = "";	
opal.Password = "";	
opal.Register();
setTimeout("EventHandler()",1000);

opal = null;
}


function LoadSoundPlayDevices()
{
var strArrRow = new Array();
strArrRow =ActiveOPAL.GetPlayerSoundDevices.split(';');
var x=document.getElementById("combo1"); 
var str = "<select id='c1' name='c1'>";
for(i=0 ; i<strArrRow.length; i++)
str += "<option value='"+strArrRow[i]+"'>"+strArrRow[i]+"</option>";
str += "</select>";
x.innerHTML = str;
}
function LoadSoundRecordDevices()
{
var strArrRow = new Array();
strArrRow =ActiveOPAL.GetRecorderSoundDevices.split(';');
var x=document.getElementById("combo2"); 
var str = "<select id='c2' name='c2'>";
for(i=0 ; i<strArrRow.length; i++)
str += "<option value='"+strArrRow[i]+"'>"+strArrRow[i]+"</option>";
str += "</select>";
x.innerHTML = str;

}
LoadSoundPlayDevices();
LoadSoundRecordDevices();


function Hangup()
{
	ActiveOPAL.HangupCall();
}
function EventHandler()
{

	if(ActiveOPAL.OutputResponse == "MSG-REGISTERING")
	{
		document.getElementById('myDiv').innerHTML = "Registering with SIP server ..."		
	}
	else if(ActiveOPAL.OutputResponse == "MSG-REGISTERED")
	{
		document.getElementById('myDiv').innerHTML = "Registered with SIP server."
		ActiveOPAL.CalledNumber = "923215026146";
		ActiveOPAL.Call();
	}
	else if(ActiveOPAL.OutputResponse == "MSG-UNREGISTERED")
	{
		document.getElementById('myDiv').innerHTML = "Un-Registered with SIP server."
	}
	else if(ActiveOPAL.OutputResponse == "MSG-UNREGISTRATION-FAILED")
	{
		document.getElementById('myDiv').innerHTML = "Registration failed with SIP server."
	}
	else if(ActiveOPAL.OutputResponse == "MSG-CALLING")
	{
		document.getElementById('myDiv').innerHTML = "Calling ..."	
	}
	else if(ActiveOPAL.OutputResponse == "MSG-HANGINGUP")
	{
		document.getElementById('myDiv').innerHTML = "Disconnecting call ..."	
	}
	else if(ActiveOPAL.OutputResponse == "MSG-RINGING")
	{
		document.getElementById('myDiv').innerHTML = "Ringing ..."	
	}
	else if(ActiveOPAL.OutputResponse == "MSG-INCONVERSATION")
	{
		document.getElementById('myDiv').innerHTML = "In Conversation"	
	}
	else if(ActiveOPAL.OutputResponse == "MSG-CALL-CLEARED")
	{
		document.getElementById('myDiv').innerHTML = "Call has been dropped"	
	}
	setTimeout("EventHandler()",1000);
}
</SCRIPT>
<input type="button" onclick="PassParameter()" value="Call" />

<input type="button" onclick="Hangup()" value="Hangup" />


</BODY>
</HTML>
